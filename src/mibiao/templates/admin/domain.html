<script id="domain" type="text/x-template">
  <div>
    <el-button class="mb-1" @click="handleAdd">增加域名</el-button>
    <el-table :data="tableData" style="width: 100%" height="666">
      <el-table-column fixed prop="domain" label="域名" width="150"></el-table-column>
      <el-table-column prop="rank" label="排序" width="80"></el-table-column>
      <el-table-column prop="description" label="描述" width="400"></el-table-column>
      <el-table-column prop="display_created_at" label="创建时间" width="180"></el-table-column>
      <el-table-column prop="display_updated_at" label="更新时间" width="180"></el-table-column>
      <el-table-column fixed="right" label="操作" width="100">
        <template #default="scope">
          <el-button link type="primary" size="small" @click="handleEdit(scope.row)">编辑</el-button>
          <el-button link type="danger" size="small" @click="handleDelete(scope.row)">删除</el-button>
        </template>
      </el-table-column>
    </el-table>
  </div>

</script>


<script>
  async function getDomainList() {
    return await sendHttpGet('/api/domains');
  }

  async function createDomain(data) {
    return await sendHttpPost('/api/domains', data);
  }

  async function updateDomain(domain_id, data) {
    return await sendHttpPut(`/api/domains/${domain_id}`, data);
  }

  async function deleteDomain(domain_id) {
    return await sendHttpDelete(`/api/domains/${domain_id}`);
  }
</script>


<script>
  const domain_component = {
    template: `#domain`,
    delimiters: ["@{", "}"],
    setup() {
      const tableData = ref([]);

      onMounted(async () => {
        const response = await getDomainList();
        const {domain_list} = await response.json();
        tableData.value = domain_list;
      });

      async function handleAdd() {
      }

      async function handleEdit(row) {

      }

      async function handleDelete(row) {

      }

      return {
        tableData,
        handleAdd,
        handleEdit,
        handleDelete,
      };
    },
  };

  routes.push({
    path: '/domain',
    name: 'domain',
    title: '域名管理',
    component: domain_component
  });
</script>